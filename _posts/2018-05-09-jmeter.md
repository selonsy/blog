---
layout: post
category: note
title: jmeter
subtitle: basic usages of jmeter
excerpt: A brief introduction of jmeter.
time: 2018.05.09 17:44:37
tags:
- jmeter
---

### jmeter简介
`Apache JMeter`是100%纯`JAVA`桌面应用程序，被设计为用于测试客户端/服务端结构的软件(例如web应用程序)。它可以用来测试静态和动态资源的性能，例如：静态文件，Java Servlet,CGI Scripts,Java Object,数据库和FTP服务器等等。JMeter可用于模拟大量负载来测试一台服务器，网络或者对象的健壮性或者分析不同负载下的整体性能。

同时，JMeter可以帮助你对你的应用程序进行`回归测试`。通过你创建的测试脚本和assertions来验证你的程序返回了所期待的值。为了更高的适应性，JMeter允许你使用正则表达式来创建这些assertions.

### jmeter安装
1. http://jmeter.apache.org/下载最新版本的JMeter，解压文件到任意目录。
2. 安装JDK，配置环境变量JAVA_HOME。
3. 系统要求：JMeter2.11 需要JDK1.6以上的版本支持运行。
4. JMeter可以运行在如下操作系统上：Unix，Windows和Open VMS。
5. 避免在一个有空格的路径安装JMeter，这将导致远程测试出现问题。
6. 插件下载地址：http://jmeter-plugins.org/downloads/all/

### jmeter运行
1. 进入bin目录运行`jmeter.bat`即可启动。
>注意：打开的时候会有两个窗口，JMeter的命令窗口和JMeter的图形操作界面，不可以关闭命令窗口。

2. 语言更改：菜单选项->选择语言->英文/中文。
### jmeter示例（获取豆瓣电影Top250列表）
1. 打开页面，包括测试计划和工作台。
2. 新建一个线程组，如下图所示：  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/线程组.jpg)
>注意：可以指定线程数（每一个线程都可以理解为一个虚拟用户）和循环次数（表示每个线程执行多少次请求）。  
>利用此配置可进行简单的压力测试，具体的可以查看这篇文章：[Jmeter教程 简单的压力测试](http://www.cnblogs.com/TankXiao/p/4059378.html?utm_source=tuicool) 

3. 新建配置元件，如下图所示：  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/配置元件.jpg)  
>配置元件（config element）用于提供对静态数据配置的支持。比如`HTTP请求默认值`就可以定义线程组内请求的默认属性，服务器地址和端口号等等。

4. 新建控制器，如下图所示：  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/控制器.jpg)
>可根据需要自行选定合适的控制器，这里使用最常用的简单控制器。

5. 新建取样器（sampler），如下图所示：  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/sampler.jpg)
>取样器（Sampler）是性能测试中向服务器发送请求，记录响应信息，记录响应时间的最小单元，JMeter 原生支持多种不同的sampler ， 如 HTTP Request Sampler 、 FTP  Request Sampler 、TCP  Request Sampler 、 JDBC Request Sampler 等，每一种不同类型的 sampler 可以根据设置的参数向服务器发出不同类型的请求。

这里新建了一个HTTP请求，用于获取后台的所有的电影列表，如下图所示：
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/Http请求示例.jpg)
>可以指定具体的接口路径以及需要同时传输的参数等等。

6. 新建监听器  
>功能：对测试结果数据进行处理和可视化展示的一系列元件。
>常用的如`图形结果`、`查看结果树`、`聚合报告`、`用表格察看结果`等等。

7. 新建断言，如下图所示：    
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/断言.jpg)
>功能：用于检查测试中得到的相应数据等是否符合预期，断言一般用来设置检查点，用以保证性能测试过程中的数据交互是否与预期一致。

8. 执行  
点击菜单栏的执行按钮（右三角符号），即可以执行线程组里面的所有处于启用状态的请求。可以在`察看结果树`里面看到请求的结果，包括请求数据及响应数据等。  
如下图所示，可以看到接口的返回值，符合预期。  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/察看结果树.jpg)

### jmeter中cookie自动存储
此功能适用于需要验证登录的接口测试。可以先新建一个简单控制器(如下面的预处理配置项)，用于登录，如下图所示：  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/登录.jpg)  

此时执行测试计划的时候，会把登录后的cookie存储并用于后面接口的请求，如下图所示：  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/cookie.jpg)

>上面第一次请求没带cookie，断言失败，显示未授权访问。
>第二次请求采用cookie存储的方式，可以看请求头里面包含了cookie项。

>注：如果需要开启此功能，需要进行如下配置  
![image](https://github.com/shenjl/MyPicRep/raw/master/GitHub/MDLearnPath/jmeter/cookie自动存储.png)

### 引用

推荐两位测试的博客，其中关于jmeter的部分非常详尽，需要的可以看一下：

* http://www.cnblogs.com/heiyexiaoguai 黑夜小怪
* http://www.cnblogs.com/yangxia-test/ 阳光温暖了心情








